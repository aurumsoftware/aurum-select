!function(){"use strict";angular.module("aurum-select",[]).directive("aurumSelect",["$filter","$document","$timeout",function(e,t,n){return{restrict:"AE",scope:{selectedModel:"=",options:"=",events:"=",search:"@",placeholder:"@",ngDisabled:"="},template:function(e,t){var n='<div class="select-parent btn-group dropdown-select" ng-class="{active: open}">';return n+='<button type="button" ng-disabled="ngDisabled" class="dropdown-toggle arButton" ng-class="settings.buttonClasses" ng-click="toggleDropdown()"><span class="arButtonLabel">{{getButtonText()}}&nbsp;</span><i class="caret"></i></button>',n+='<ul class="dropdown-menu dropdown-menu-form" ng-style="{display: (open) ? \'block\' : \'none\' }" style="overflow: scroll" >',n+='<li ng-show="enableSearch"><div class="dropdown-header"><input type="text" class="form-control" style="width: 100%;" ng-model="searchFilter" placeholder="{{texts.searchPlaceholder}}" /></li>',n+='<li class="presentation" role="presentation" ng-repeat="option in options | filter: searchFilter">',n+="<div class=\"menu-item\" data-ng-class=\"{'selected': isChecked(getPropertyForObject(option,settings.idProp)), 'not-selected': !isChecked(getPropertyForObject(option,settings.idProp))}\">",n+='<div class="menu-item-label" role="menuitem" tabindex="-1" ng-click="setSelectedItem(getPropertyForObject(option,settings.idProp))" title="{{getPropertyForObject(option, settings.displayProp)}}" >{{getPropertyForObject(option, settings.displayProp)}}</div>',n+="</li>",n+="</ul>",n+="</div>"},link:function(e,o,l){function s(t){var n={};return""===e.settings.externalIdProp?n[e.settings.idProp]=t:n[e.settings.externalIdProp]=t,n}function r(e){for(var t in e)delete e[t]}e.settings={displayProp:"label",idProp:"id",externalIdProp:"id",buttonClasses:"btn btn-default"},e.texts={searchPlaceholder:l.search,buttonDefaultText:l.placeholder||"Select"},e.externalEvents={onItemSelect:angular.noop,onInitDone:angular.noop},l.search?e.enableSearch=!0:e.enableSearch=!1;var i=o.children()[0];e.toggleDropdown=function(){e.open=!e.open,n(function(){o[0].querySelector(".form-control").focus()},200)},e.checkboxClick=function(t,n){e.setSelectedItem(n),t.stopImmediatePropagation()},e.searchFilter=e.searchFilter||"",angular.extend(e.settings,e.extraSettings||[]),angular.extend(e.externalEvents,e.events||[]),angular.extend(e.texts,e.translationTexts),e.singleSelection=!0,e.singleSelection&&angular.isArray(e.selectedModel)&&0===e.selectedModel.length&&r(e.selectedModel);var a=function(t){for(var n=t.target.parentElement,o=!1;angular.isDefined(n)&&null!==n&&!o;)_.contains(n.className.split(" "),"select-parent")&&!o&&n===i&&(o=!0),n=n.parentElement;o||e.$apply(function(){e.open=!1})};t.on("click",a),e.$on("$destroy",function(){e.settings.closeOnBlur&&t.off("click",a)}),e.getButtonText=function(){if(e.selectedModel.length>0||_.keys(e.selectedModel).length>0){var t=[];return angular.forEach(e.options,function(n){if(e.isChecked(e.getPropertyForObject(n,e.settings.idProp))){var o=e.getPropertyForObject(n,e.settings.displayProp),l=angular.noop(o,n);t.push(l?l:o)}}),e.selectedModel.length>e.settings.smartButtonMaxItems&&(t=t.slice(0,e.settings.smartButtonMaxItems),t.push("...")),t.join(", ")}return e.texts.buttonDefaultText},e.getPropertyForObject=function(e,t){return angular.isDefined(e)&&e.hasOwnProperty(t)?e[t]:""},e.setSelectedItem=function(t,n){var o=s(t),l=null;l=""===e.settings.externalIdProp?_.find(e.options,o):o,r(e.selectedModel),angular.extend(e.selectedModel,l),e.externalEvents.onItemSelect(l),e.open=!1,n=n||!1;var i=_.findIndex(e.selectedModel,o)!==-1;!n&&i&&e.selectedModel.splice(_.findIndex(e.selectedModel,o),1)},e.isChecked=function(t){return e.singleSelection?null!==e.selectedModel&&angular.isDefined(e.selectedModel[e.settings.idProp])&&e.selectedModel[e.settings.idProp]===s(t)[e.settings.idProp]:_.findIndex(e.selectedModel,s(t))!==-1},e.externalEvents.onInitDone()}}}])}();